<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SlayerApp.ViewModel"
             xmlns:model="using:SlayerApp.Model"
			 xmlns:local="using:SlayerApp"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
			 x:DataType="vm:PlaylistViewModel"
             x:Class="SlayerApp.Views.PlaylistView">
  <UserControl.Resources>
		<DrawingImage x:Key="PlayIcon">
			<DrawingImage.Drawing>
				<GeometryDrawing Brush="Black" Geometry="M8 5v14l11-7z"/>
			</DrawingImage.Drawing>
		</DrawingImage>
	</UserControl.Resources>

	<ScrollViewer>
		<StackPanel>

			<!-- Header Section with Album Art and Info -->
			<Grid Margin="24" ColumnDefinitions="Auto,*">
				<!-- Album Cover -->
				<Border Grid.Column="0"
						Width="232" Height="232"
						CornerRadius="4"
						ClipToBounds="True"
						BoxShadow="0 8 24 0 #40000000">
					<Panel>
						<Border Background="#282828">
							<PathIcon Data="{StaticResource music_regular}"
									  Foreground="#535353"
									  Width="80" Height="80"/>
						</Border>
						<Image Source="{Binding Cover^}"
							   Stretch="UniformToFill"/>
					</Panel>
				</Border>

				<!-- Album Info -->
				<StackPanel Grid.Column="1"
							Margin="24,0,0,0"
							VerticalAlignment="Bottom">

					<TextBlock Text="Album"
							   FontSize="12"
							   FontWeight="Bold"
							   Foreground="White"/>

					<TextBlock Text="{Binding Name}"
							   FontSize="48"
							   FontWeight="Bold"
							   Foreground="White"
							   TextWrapping="Wrap"
							   Margin="0,8,0,0"/>

					<StackPanel Orientation="Horizontal"
								Margin="0,16,0,0"
								Spacing="4">
						<TextBlock Text="{Binding Name}"
								   FontSize="14"
								   FontWeight="Bold"
								   Foreground="White"/>
						<TextBlock FontSize="14"
								   Foreground="#B3B3B3">
							<TextBlock.Text>
								<!--<MultiBinding StringFormat="{}{0} songs, {1}">
									<Binding Path="SongCount"/>
									<Binding Path="TotalDuration"/>
								</MultiBinding>-->
							</TextBlock.Text>
						</TextBlock>
					</StackPanel>
				</StackPanel>
			</Grid>

			<!-- Action Buttons -->
			<StackPanel Orientation="Horizontal"
						Margin="24,8,24,16"
						Spacing="16">

				<!-- Play Button -->
				<Button Width="56" Height="56"
						CornerRadius="28"
						Background="#2670B9"
						BorderThickness="0"
						Cursor="Hand"
						Command="{Binding PlayPlaylistCommand}">
					<Button.Styles>
						<Style Selector="Button:pointerover">
							<Setter Property="Background" Value="#1ED760"/>
							<Setter Property="RenderTransform" Value="scale(1.04)"/>
						</Style>
					</Button.Styles>
					<PathIcon Width="24" Height="24" Foreground="Black">
						<PathIcon.Data>
							<PathGeometry>M8 5v14l11-7z</PathGeometry>
						</PathIcon.Data>
					</PathIcon>
				</Button>

				<!-- Shuffle Button -->
				<ToggleButton Width="32" Height="32"
							  Background="Transparent"
							  BorderThickness="0"
							  Cursor="Hand"
							  Opacity="0.7"
							  IsChecked="{Binding Shuffle}"
							  Command="{Binding ToggleShuffleCommand}">
					<ToggleButton.Styles>
						<Style Selector="ToggleButton:pointerover PathIcon">
							<Setter Property="Foreground" Value="White"/>
						</Style>
						<Style Selector="ToggleButton:checked PathIcon">
							<Setter Property="Foreground" Value="#1DB954"/>
						</Style>
					</ToggleButton.Styles>
					<PathIcon Width="24" Height="24" Foreground="#B3B3B3">
						<PathIcon.Data>
							<PathGeometry>M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z</PathGeometry>
						</PathIcon.Data>
					</PathIcon>
				</ToggleButton>

				<!-- More Options Button -->
				<Button Width="32" Height="32"
						Background="Transparent"
						BorderThickness="0"
						Cursor="Hand"
						Opacity="0.7">
					<Button.Flyout>
						<MenuFlyout>
							<MenuItem Header="Add to Queue"
									  Command="{Binding AddPlaylistToQueueCommand}">
								<MenuItem.Icon>
									<PathIcon Data="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/>
								</MenuItem.Icon>
							</MenuItem>
							<Separator/>
							<MenuItem Header="Add to Playlist">
								<MenuItem.Icon>
									<PathIcon Data="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
								</MenuItem.Icon>
							</MenuItem>
							<Separator/>
							<MenuItem Header="Change playlist image"
									  Command="{Binding ChangePlaylistImageCommand}">
								<MenuItem.Icon>
									<PathIcon Data="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
								</MenuItem.Icon>
							</MenuItem>
							<MenuItem Header="Pin">
								<MenuItem.Icon>
									<PathIcon Data="M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3z"/>
								</MenuItem.Icon>
							</MenuItem>
							<MenuItem Header="Show in Explorer">
								<MenuItem.Icon>
									<PathIcon Data="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"/>
								</MenuItem.Icon>
							</MenuItem>
						</MenuFlyout>
					</Button.Flyout>
					<Button.Styles>
						<Style Selector="Button:pointerover">
							<Setter Property="Opacity" Value="1"/>
						</Style>
					</Button.Styles>
					<PathIcon Width="24" Height="24" Foreground="#B3B3B3">
						<PathIcon.Data>
							<PathGeometry>M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z</PathGeometry>
						</PathIcon.Data>
					</PathIcon>
				</Button>
			</StackPanel>

			<!-- Track List Header -->
			<Grid Margin="24,0,24,8"
				  ColumnDefinitions="48,*,Auto"
				  Opacity="0.7">
				<TextBlock Grid.Column="0"
						   Text="#"
						   FontSize="14"
						   Foreground="#B3B3B3"
						   HorizontalAlignment="Center"/>
				<TextBlock Grid.Column="1"
						   Text="Title"
						   FontSize="14"
						   Foreground="#B3B3B3"/>
				<PathIcon Grid.Column="2"
						  Width="16" Height="16"
						  Foreground="#B3B3B3"
						  Margin="0,0,16,0">
					<PathIcon.Data>
						<PathGeometry>M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z</PathGeometry>
					</PathIcon.Data>
				</PathIcon>
			</Grid>

			<Border Height="1" Background="#282828" Margin="24,0"/>

			<!-- Song List -->
			<ItemsControl ItemsSource="{Binding TrackList, UpdateSourceTrigger=PropertyChanged}" Margin="0,8,0,24">
				<ItemsControl.ItemTemplate>
					<DataTemplate x:DataType="model:Song">
						<Border Padding="24,8"
								Background="Transparent"
								Cursor="Hand"
								CornerRadius="4">
							<Border.ContextFlyout>
								<MenuFlyout>
									<MenuItem Header="Add to queue"
											  Command="{Binding AddToQueue}">
										<MenuItem.Icon>
											<PathIcon Data="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
										</MenuItem.Icon>
									</MenuItem>
									<MenuItem Header="Add to Playlist">
										<MenuItem.Icon>
											<PathIcon Data="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
										</MenuItem.Icon>
									</MenuItem>
								</MenuFlyout>
							</Border.ContextFlyout>
							<Border.Styles>
								<Style Selector="Border:pointerover">
									<Setter Property="Background" Value="#1A1A1A"/>
								</Style>
								<Style Selector="Border:pointerover TextBlock#TrackNum">
									<Setter Property="IsVisible" Value="False"/>
								</Style>
								<Style Selector="Button#PlayBtn">
									<Setter Property="IsVisible" Value="False"/>
								</Style>
								<Style Selector="Border:pointerover Button#PlayBtn">
									<Setter Property="IsVisible" Value="True"/>
								</Style>
								<Style Selector="Border:pointerover TextBlock#SongTitle">
									<Setter Property="Foreground" Value="White"/>
								</Style>
								<Style Selector="Border:pointerover TextBlock#SongArtist">
									<Setter Property="Foreground" Value="White"/>
								</Style>
								<Style Selector="Border:pointerover TextBlock#SongDuration">
									<Setter Property="Foreground" Value="White"/>
								</Style>
							</Border.Styles>

							<Grid ColumnDefinitions="48,*,Auto">

								<!-- Track Number / Play Icon -->
								<Panel Grid.Column="0">
									<TextBlock Text="{Binding TrackNumber}"
											   FontSize="16"
											   Foreground="#B3B3B3"
											   HorizontalAlignment="Center"
											   VerticalAlignment="Center"
											   Name="TrackNum"/>
									<Button Background="Transparent"
											BorderThickness="0"
											Command="{Binding Play}"
											Name="PlayBtn"
											HorizontalAlignment="Center"
											VerticalAlignment="Center"
											Foreground="#B3B3B3">
										<PathIcon Width="16" Height="16" Foreground="White">
											<PathIcon.Data>
												<PathGeometry>M8 5v14l11-7z</PathGeometry>
											</PathIcon.Data>
										</PathIcon>
									</Button>
								</Panel>

								<!-- Title and Artist -->
								<StackPanel Grid.Column="1" VerticalAlignment="Center">
									<TextBlock Text="{Binding Title}"
											   FontSize="16"
											   Foreground="White"
											   TextTrimming="CharacterEllipsis"
											   Name="SongTitle"/>
									<TextBlock Text="{Binding Artists}"
											   FontSize="14"
											   Foreground="#B3B3B3"
											   TextTrimming="CharacterEllipsis"
											   Margin="0,2,0,0"
											   Name="SongArtist"/>
								</StackPanel>

								<!-- Duration -->
								<TextBlock Grid.Column="2"
										   Text="{Binding DurationFormatted}"
										   FontSize="14"
										   Foreground="#B3B3B3"
										   VerticalAlignment="Center"
										   Margin="16,0"
										   Name="SongDuration"/>
							</Grid>
						</Border>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			</ItemsControl>

		</StackPanel>
	</ScrollViewer>
</UserControl>
